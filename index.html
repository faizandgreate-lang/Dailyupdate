<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Live Editable Google Sheet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial; margin: 10px; background: #f8f9fa; }
  h2 { text-align: center; color: #333; }
  .table-container { max-height: 500px; overflow: auto; border: 1px solid #ddd; background: white; }
  table { width: 100%; border-collapse: collapse; }
  th, td { padding: 8px; border: 1px solid #ddd; text-align: left; min-width: 100px; }
  th { background: #f0f0f0; position: sticky; top: 0; cursor: pointer; }
  td { cursor: pointer; }
  tr:hover { background-color: #f1f1f1; }
</style>
</head>
<body>

<h2>Live Editable Google Sheet</h2>
<div class="table-container">
  <table id="sheetTable">
    <thead></thead>
    <tbody></tbody>
  </table>
</div>

<script>
const SHEET_ID = 'YOUR_SHEET_ID';
const SHEET_NAME = 'Update';
const API_KEY = 'YOUR_API_KEY';
const CLIENT_ID = 'YOUR_OAUTH_CLIENT_ID';
const SCOPES = "https://www.googleapis.com/auth/spreadsheets";

let tableData = [];

// Load Google API
function loadGapi() {
  gapi.load('client:auth2', initClient);
}

// Initialize Google API Client
function initClient() {
  gapi.client.init({
    apiKey: API_KEY,
    clientId: CLIENT_ID,
    discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    scope: SCOPES
  }).then(() => {
    gapi.auth2.getAuthInstance().signIn().then(fetchSheet);
  });
}

// Fetch sheet data
function fetchSheet() {
  gapi.client.sheets.spreadsheets.values.get({
    spreadsheetId: SHEET_ID,
    range: SHEET_NAME
  }).then(response => {
    tableData = response.result.values;
    renderTable();
  });
}

// Render table
function renderTable() {
  const table = document.getElementById('sheetTable');
  table.innerHTML = '';

  // Header
  const headerRow = document.createElement('tr');
  tableData[0].forEach((h, i) => {
    const th = document.createElement('th');
    th.innerText = h;
    headerRow.appendChild(th);
  });
  table.appendChild(headerRow);

  // Body
  tableData.slice(1).forEach((row, rIdx) => {
    const tr = document.createElement('tr');
    row.forEach((cell, cIdx) => {
      const td = document.createElement('td');
      td.innerText = cell || '';
      td.contentEditable = true;

      td.addEventListener('blur', () => {
        tableData[rIdx + 1][cIdx] = td.innerText;
        updateSheet(rIdx + 1, cIdx, td.innerText);
      });

      tr.appendChild(td);
    });
    table.appendChild(tr);
  });
}

// Update Google Sheet cell
function updateSheet(row, col, value) {
  gapi.client.sheets.spreadsheets.values.update({
    spreadsheetId: SHEET_ID,
    range: `${SHEET_NAME}!${columnToLetter(col + 1)}${row + 1}`,
    valueInputOption: 'RAW',
    resource: { values: [[value]] }
  }).then(() => console.log('Cell updated'));
}

// Convert column number to letter (1 => A)
function columnToLetter(column) {
  let temp, letter = '';
  while (column > 0) {
    temp = (column - 1) % 26;
    letter = String.fromCharCode(temp + 65) + letter;
    column = (column - temp - 1) / 26;
  }
  return letter;
}

// Load Google API script
const script = document.createElement('script');
script.src = "https://apis.google.com/js/api.js";
script.onload = loadGapi;
document.body.appendChild(script);
</script>

</body>
</html>
